var Http=require("http"),Request=require("request"),Hawk=require("../lib"),internals={credentials:{dh37fgj492je:{id:"dh37fgj492je",key:"werxhqb98rpaxn39848xrunpaw3489ruxnpa98w4rxn",algorithm:"sha256",user:"Steve"}}},credentialsFunc=function(e,t){return t(null,internals.credentials[e])},handler=function(e,t){Hawk.server.authenticate(e,credentialsFunc,{},function(e,r,a){var n=e?"Shoosh!":"Hello "+r.user+" "+a.ext,i={"Content-Type":"text/plain","Server-Authorization":Hawk.server.header(r,a,{payload:n,contentType:"text/plain"})};t.writeHead(e?401:200,i),t.end(n)})};Http.createServer(handler).listen(8e3,"127.0.0.1"),Request("http://127.0.0.1:8000/resource/1?b=1&a=2",function(e,t,r){console.log(t.statusCode+": "+r)}),credentialsFunc("dh37fgj492je",function(e,t){var r=Hawk.client.header("http://127.0.0.1:8000/resource/1?b=1&a=2","GET",{credentials:t,ext:"and welcome!"}),a={uri:"http://127.0.0.1:8000/resource/1?b=1&a=2",method:"GET",headers:{authorization:r.field}};Request(a,function(e,a,n){var i=Hawk.client.authenticate(a,t,r.artifacts,{payload:n});console.log(a.statusCode+": "+n+(i?" (valid)":" (invalid)")),process.exit(0)})});