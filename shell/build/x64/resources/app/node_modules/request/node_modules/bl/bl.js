function BufferList(t){if(!(this instanceof BufferList))return new BufferList(t);if(this._bufs=[],this.length=0,"function"==typeof t){this._callback=t;var e=function(t){this._callback&&(this._callback(t),this._callback=null)}.bind(this);this.on("pipe",function(t){t.on("error",e)}),this.on("unpipe",function(t){t.removeListener("error",e)})}else this.append(t);DuplexStream.call(this)}var DuplexStream=require("readable-stream/duplex"),util=require("util");util.inherits(BufferList,DuplexStream),BufferList.prototype._offset=function(t){for(var e,i=0,s=0;s<this._bufs.length;s++){if(e=i+this._bufs[s].length,e>t)return[s,t-i];i=e}},BufferList.prototype.append=function(t){var e,i=0;if(Array.isArray(t))for(;i<t.length;i++)this.append(t[i]);else if(t instanceof BufferList)for(;i<t._bufs.length;i++)this.append(t._bufs[i]);else null!=t&&("number"==typeof t&&(t=t.toString()),e=Buffer.isBuffer(t)?t:new Buffer(t),this._bufs.push(e),this.length+=e.length);return this},BufferList.prototype._write=function(t,e,i){this.append(t),"function"==typeof i&&i()},BufferList.prototype._read=function(t){return this.length?(t=Math.min(t,this.length),this.push(this.slice(0,t)),void this.consume(t)):this.push(null)},BufferList.prototype.end=function(t){DuplexStream.prototype.end.call(this,t),this._callback&&(this._callback(null,this.slice()),this._callback=null)},BufferList.prototype.get=function(t){return this.slice(t,t+1)[0]},BufferList.prototype.slice=function(t,e){return this.copy(null,0,t,e)},BufferList.prototype.copy=function t(e,i,s,n){if(("number"!=typeof s||0>s)&&(s=0),("number"!=typeof n||n>this.length)&&(n=this.length),s>=this.length)return e||new Buffer(0);if(0>=n)return e||new Buffer(0);var r,f,t=!!e,u=this._offset(s),h=n-s,o=h,l=t&&i||0,p=u[1];if(0===s&&n==this.length){if(!t)return Buffer.concat(this._bufs);for(f=0;f<this._bufs.length;f++)this._bufs[f].copy(e,l),l+=this._bufs[f].length;return e}if(o<=this._bufs[u[0]].length-p)return t?this._bufs[u[0]].copy(e,i,p,p+o):this._bufs[u[0]].slice(p,p+o);for(t||(e=new Buffer(h)),f=u[0];f<this._bufs.length;f++){if(r=this._bufs[f].length-p,!(o>r)){this._bufs[f].copy(e,l,p,p+o);break}this._bufs[f].copy(e,l,p),l+=r,o-=r,p&&(p=0)}return e},BufferList.prototype.toString=function(t,e,i){return this.slice(e,i).toString(t)},BufferList.prototype.consume=function(t){for(;this._bufs.length;){if(!(t>=this._bufs[0].length)){this._bufs[0]=this._bufs[0].slice(t),this.length-=t;break}t-=this._bufs[0].length,this.length-=this._bufs[0].length,this._bufs.shift()}return this},BufferList.prototype.duplicate=function(){for(var t=0,e=new BufferList;t<this._bufs.length;t++)e.append(this._bufs[t]);return e},BufferList.prototype.destroy=function(){this._bufs.length=0,this.length=0,this.push(null)},function(){var t={readDoubleBE:8,readDoubleLE:8,readFloatBE:4,readFloatLE:4,readInt32BE:4,readInt32LE:4,readUInt32BE:4,readUInt32LE:4,readInt16BE:2,readInt16LE:2,readUInt16BE:2,readUInt16LE:2,readInt8:1,readUInt8:1};for(var e in t)!function(e){BufferList.prototype[e]=function(i){return this.slice(i,i+t[e])[e](0)}}(e)}(),module.exports=BufferList;