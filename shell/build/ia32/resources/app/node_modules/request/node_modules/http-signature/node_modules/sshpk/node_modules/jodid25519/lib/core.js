"use strict";function _setbit(n,r,u){var d=r>>4,o=n[d];o+=(1<<(15&r))*u,n[d]=o}function _getbit(n,r){return n[r>>4]>>(15&r)&1}function _ZERO(){return[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}function _ONE(){return[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}function _BASE(){return[9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}function _bigintcmp(n,r){var u,d,o,_=0;for(u=15;u>=0;u--){var m=n[u],t=r[u];_+=(m-t)*(1-_*_),o=_>>31,d=_+o^o,_=~~((_<<1)/(d+1))}return _}function _bigintadd(n,r){var u,d=[];return d[0]=65535&(u=n[0]+r[0]),d[1]=65535&(u=(u>>>16)+n[1]+r[1]),d[2]=65535&(u=(u>>>16)+n[2]+r[2]),d[3]=65535&(u=(u>>>16)+n[3]+r[3]),d[4]=65535&(u=(u>>>16)+n[4]+r[4]),d[5]=65535&(u=(u>>>16)+n[5]+r[5]),d[6]=65535&(u=(u>>>16)+n[6]+r[6]),d[7]=65535&(u=(u>>>16)+n[7]+r[7]),d[8]=65535&(u=(u>>>16)+n[8]+r[8]),d[9]=65535&(u=(u>>>16)+n[9]+r[9]),d[10]=65535&(u=(u>>>16)+n[10]+r[10]),d[11]=65535&(u=(u>>>16)+n[11]+r[11]),d[12]=65535&(u=(u>>>16)+n[12]+r[12]),d[13]=65535&(u=(u>>>16)+n[13]+r[13]),d[14]=65535&(u=(u>>>16)+n[14]+r[14]),d[15]=(u>>>16)+n[15]+r[15],d}function _bigintsub(n,r){var u,d=[];return d[0]=65535&(u=524288+n[0]-r[0]),d[1]=65535&(u=(u>>>16)+524280+n[1]-r[1]),d[2]=65535&(u=(u>>>16)+524280+n[2]-r[2]),d[3]=65535&(u=(u>>>16)+524280+n[3]-r[3]),d[4]=65535&(u=(u>>>16)+524280+n[4]-r[4]),d[5]=65535&(u=(u>>>16)+524280+n[5]-r[5]),d[6]=65535&(u=(u>>>16)+524280+n[6]-r[6]),d[7]=65535&(u=(u>>>16)+524280+n[7]-r[7]),d[8]=65535&(u=(u>>>16)+524280+n[8]-r[8]),d[9]=65535&(u=(u>>>16)+524280+n[9]-r[9]),d[10]=65535&(u=(u>>>16)+524280+n[10]-r[10]),d[11]=65535&(u=(u>>>16)+524280+n[11]-r[11]),d[12]=65535&(u=(u>>>16)+524280+n[12]-r[12]),d[13]=65535&(u=(u>>>16)+524280+n[13]-r[13]),d[14]=65535&(u=(u>>>16)+524280+n[14]-r[14]),d[15]=(u>>>16)-8+n[15]-r[15],d}function _sqr8h(n,r,u,d,o,_,m,t){var s,e=[];return e[0]=65535&(s=t*t),e[1]=65535&(s=(0|s/65536)+2*t*m),e[2]=65535&(s=(0|s/65536)+2*t*_+m*m),e[3]=65535&(s=(0|s/65536)+2*t*o+2*m*_),e[4]=65535&(s=(0|s/65536)+2*t*d+2*m*o+_*_),e[5]=65535&(s=(0|s/65536)+2*t*u+2*m*d+2*_*o),e[6]=65535&(s=(0|s/65536)+2*t*r+2*m*u+2*_*d+o*o),e[7]=65535&(s=(0|s/65536)+2*t*n+2*m*r+2*_*u+2*o*d),e[8]=65535&(s=(0|s/65536)+2*m*n+2*_*r+2*o*u+d*d),e[9]=65535&(s=(0|s/65536)+2*_*n+2*o*r+2*d*u),e[10]=65535&(s=(0|s/65536)+2*o*n+2*d*r+u*u),e[11]=65535&(s=(0|s/65536)+2*d*n+2*u*r),e[12]=65535&(s=(0|s/65536)+2*u*n+r*r),e[13]=65535&(s=(0|s/65536)+2*r*n),e[14]=65535&(s=(0|s/65536)+n*n),e[15]=0|s/65536,e}function _sqrmodp(n){var r,u=_sqr8h(n[15],n[14],n[13],n[12],n[11],n[10],n[9],n[8]),d=_sqr8h(n[7],n[6],n[5],n[4],n[3],n[2],n[1],n[0]),o=_sqr8h(n[15]+n[7],n[14]+n[6],n[13]+n[5],n[12]+n[4],n[11]+n[3],n[10]+n[2],n[9]+n[1],n[8]+n[0]),_=[];return _[0]=65535&(r=8388608+d[0]+38*(o[8]-u[8]-d[8]+u[0]-128)),_[1]=65535&(r=8388480+(r>>>16)+d[1]+38*(o[9]-u[9]-d[9]+u[1])),_[2]=65535&(r=8388480+(r>>>16)+d[2]+38*(o[10]-u[10]-d[10]+u[2])),_[3]=65535&(r=8388480+(r>>>16)+d[3]+38*(o[11]-u[11]-d[11]+u[3])),_[4]=65535&(r=8388480+(r>>>16)+d[4]+38*(o[12]-u[12]-d[12]+u[4])),_[5]=65535&(r=8388480+(r>>>16)+d[5]+38*(o[13]-u[13]-d[13]+u[5])),_[6]=65535&(r=8388480+(r>>>16)+d[6]+38*(o[14]-u[14]-d[14]+u[6])),_[7]=65535&(r=8388480+(r>>>16)+d[7]+38*(o[15]-u[15]-d[15]+u[7])),_[8]=65535&(r=8388480+(r>>>16)+d[8]+o[0]-u[0]-d[0]+38*u[8]),_[9]=65535&(r=8388480+(r>>>16)+d[9]+o[1]-u[1]-d[1]+38*u[9]),_[10]=65535&(r=8388480+(r>>>16)+d[10]+o[2]-u[2]-d[2]+38*u[10]),_[11]=65535&(r=8388480+(r>>>16)+d[11]+o[3]-u[3]-d[3]+38*u[11]),_[12]=65535&(r=8388480+(r>>>16)+d[12]+o[4]-u[4]-d[4]+38*u[12]),_[13]=65535&(r=8388480+(r>>>16)+d[13]+o[5]-u[5]-d[5]+38*u[13]),_[14]=65535&(r=8388480+(r>>>16)+d[14]+o[6]-u[6]-d[6]+38*u[14]),_[15]=8388480+(r>>>16)+d[15]+o[7]-u[7]-d[7]+38*u[15],_reduce(_),_}function _mul8h(n,r,u,d,o,_,m,t,s,e,i,p,a,c,l,b){var f,v=[];return v[0]=65535&(f=t*b),v[1]=65535&(f=(0|f/65536)+t*l+m*b),v[2]=65535&(f=(0|f/65536)+t*c+m*l+_*b),v[3]=65535&(f=(0|f/65536)+t*a+m*c+_*l+o*b),v[4]=65535&(f=(0|f/65536)+t*p+m*a+_*c+o*l+d*b),v[5]=65535&(f=(0|f/65536)+t*i+m*p+_*a+o*c+d*l+u*b),v[6]=65535&(f=(0|f/65536)+t*e+m*i+_*p+o*a+d*c+u*l+r*b),v[7]=65535&(f=(0|f/65536)+t*s+m*e+_*i+o*p+d*a+u*c+r*l+n*b),v[8]=65535&(f=(0|f/65536)+m*s+_*e+o*i+d*p+u*a+r*c+n*l),v[9]=65535&(f=(0|f/65536)+_*s+o*e+d*i+u*p+r*a+n*c),v[10]=65535&(f=(0|f/65536)+o*s+d*e+u*i+r*p+n*a),v[11]=65535&(f=(0|f/65536)+d*s+u*e+r*i+n*p),v[12]=65535&(f=(0|f/65536)+u*s+r*e+n*i),v[13]=65535&(f=(0|f/65536)+r*s+n*e),v[14]=65535&(f=(0|f/65536)+n*s),v[15]=0|f/65536,v}function _mulmodp(n,r){var u,d=_mul8h(n[15],n[14],n[13],n[12],n[11],n[10],n[9],n[8],r[15],r[14],r[13],r[12],r[11],r[10],r[9],r[8]),o=_mul8h(n[7],n[6],n[5],n[4],n[3],n[2],n[1],n[0],r[7],r[6],r[5],r[4],r[3],r[2],r[1],r[0]),_=_mul8h(n[15]+n[7],n[14]+n[6],n[13]+n[5],n[12]+n[4],n[11]+n[3],n[10]+n[2],n[9]+n[1],n[8]+n[0],r[15]+r[7],r[14]+r[6],r[13]+r[5],r[12]+r[4],r[11]+r[3],r[10]+r[2],r[9]+r[1],r[8]+r[0]),m=[];return m[0]=65535&(u=8388608+o[0]+38*(_[8]-d[8]-o[8]+d[0]-128)),m[1]=65535&(u=8388480+(u>>>16)+o[1]+38*(_[9]-d[9]-o[9]+d[1])),m[2]=65535&(u=8388480+(u>>>16)+o[2]+38*(_[10]-d[10]-o[10]+d[2])),m[3]=65535&(u=8388480+(u>>>16)+o[3]+38*(_[11]-d[11]-o[11]+d[3])),m[4]=65535&(u=8388480+(u>>>16)+o[4]+38*(_[12]-d[12]-o[12]+d[4])),m[5]=65535&(u=8388480+(u>>>16)+o[5]+38*(_[13]-d[13]-o[13]+d[5])),m[6]=65535&(u=8388480+(u>>>16)+o[6]+38*(_[14]-d[14]-o[14]+d[6])),m[7]=65535&(u=8388480+(u>>>16)+o[7]+38*(_[15]-d[15]-o[15]+d[7])),m[8]=65535&(u=8388480+(u>>>16)+o[8]+_[0]-d[0]-o[0]+38*d[8]),m[9]=65535&(u=8388480+(u>>>16)+o[9]+_[1]-d[1]-o[1]+38*d[9]),m[10]=65535&(u=8388480+(u>>>16)+o[10]+_[2]-d[2]-o[2]+38*d[10]),m[11]=65535&(u=8388480+(u>>>16)+o[11]+_[3]-d[3]-o[3]+38*d[11]),m[12]=65535&(u=8388480+(u>>>16)+o[12]+_[4]-d[4]-o[4]+38*d[12]),m[13]=65535&(u=8388480+(u>>>16)+o[13]+_[5]-d[5]-o[5]+38*d[13]),m[14]=65535&(u=8388480+(u>>>16)+o[14]+_[6]-d[6]-o[6]+38*d[14]),m[15]=8388480+(u>>>16)+o[15]+_[7]-d[7]-o[7]+38*d[15],_reduce(m),m}function _reduce(n){var r=n.slice(0),u=[n,r],d=n[15],o=u[32768>d&1];o[15]=32767&d,d=19*(0|d/32768),o[0]=65535&(d+=o[0]),d>>>=16,o[1]=65535&(d+=o[1]),d>>>=16,o[2]=65535&(d+=o[2]),d>>>=16,o[3]=65535&(d+=o[3]),d>>>=16,o[4]=65535&(d+=o[4]),d>>>=16,o[5]=65535&(d+=o[5]),d>>>=16,o[6]=65535&(d+=o[6]),d>>>=16,o[7]=65535&(d+=o[7]),d>>>=16,o[8]=65535&(d+=o[8]),d>>>=16,o[9]=65535&(d+=o[9]),d>>>=16,o[10]=65535&(d+=o[10]),d>>>=16,o[11]=65535&(d+=o[11]),d>>>=16,o[12]=65535&(d+=o[12]),d>>>=16,o[13]=65535&(d+=o[13]),d>>>=16,o[14]=65535&(d+=o[14]),d>>>=16,o[15]+=d}function _addmodp(n,r){var u,d=[];return d[0]=65535&(u=19*((0|n[15]>>>15)+(0|r[15]>>>15))+n[0]+r[0]),d[1]=65535&(u=(u>>>16)+n[1]+r[1]),d[2]=65535&(u=(u>>>16)+n[2]+r[2]),d[3]=65535&(u=(u>>>16)+n[3]+r[3]),d[4]=65535&(u=(u>>>16)+n[4]+r[4]),d[5]=65535&(u=(u>>>16)+n[5]+r[5]),d[6]=65535&(u=(u>>>16)+n[6]+r[6]),d[7]=65535&(u=(u>>>16)+n[7]+r[7]),d[8]=65535&(u=(u>>>16)+n[8]+r[8]),d[9]=65535&(u=(u>>>16)+n[9]+r[9]),d[10]=65535&(u=(u>>>16)+n[10]+r[10]),d[11]=65535&(u=(u>>>16)+n[11]+r[11]),d[12]=65535&(u=(u>>>16)+n[12]+r[12]),d[13]=65535&(u=(u>>>16)+n[13]+r[13]),d[14]=65535&(u=(u>>>16)+n[14]+r[14]),d[15]=(u>>>16)+(32767&n[15])+(32767&r[15]),d}function _submodp(n,r){var u,d=[];return d[0]=65535&(u=524288+19*((0|n[15]>>>15)-(0|r[15]>>>15)-1)+n[0]-r[0]),d[1]=65535&(u=(u>>>16)+524280+n[1]-r[1]),d[2]=65535&(u=(u>>>16)+524280+n[2]-r[2]),d[3]=65535&(u=(u>>>16)+524280+n[3]-r[3]),d[4]=65535&(u=(u>>>16)+524280+n[4]-r[4]),d[5]=65535&(u=(u>>>16)+524280+n[5]-r[5]),d[6]=65535&(u=(u>>>16)+524280+n[6]-r[6]),d[7]=65535&(u=(u>>>16)+524280+n[7]-r[7]),d[8]=65535&(u=(u>>>16)+524280+n[8]-r[8]),d[9]=65535&(u=(u>>>16)+524280+n[9]-r[9]),d[10]=65535&(u=(u>>>16)+524280+n[10]-r[10]),d[11]=65535&(u=(u>>>16)+524280+n[11]-r[11]),d[12]=65535&(u=(u>>>16)+524280+n[12]-r[12]),d[13]=65535&(u=(u>>>16)+524280+n[13]-r[13]),d[14]=65535&(u=(u>>>16)+524280+n[14]-r[14]),d[15]=(u>>>16)+32760+(32767&n[15])-(32767&r[15]),d}function _invmodp(n){for(var r=n,u=250;--u;)n=_sqrmodp(n),n=_mulmodp(n,r);return n=_sqrmodp(n),n=_sqrmodp(n),n=_mulmodp(n,r),n=_sqrmodp(n),n=_sqrmodp(n),n=_mulmodp(n,r),n=_sqrmodp(n),n=_mulmodp(n,r)}function _mulasmall(n){var r,u=121665,d=[];return d[0]=65535&(r=n[0]*u),d[1]=65535&(r=(0|r/65536)+n[1]*u),d[2]=65535&(r=(0|r/65536)+n[2]*u),d[3]=65535&(r=(0|r/65536)+n[3]*u),d[4]=65535&(r=(0|r/65536)+n[4]*u),d[5]=65535&(r=(0|r/65536)+n[5]*u),d[6]=65535&(r=(0|r/65536)+n[6]*u),d[7]=65535&(r=(0|r/65536)+n[7]*u),d[8]=65535&(r=(0|r/65536)+n[8]*u),d[9]=65535&(r=(0|r/65536)+n[9]*u),d[10]=65535&(r=(0|r/65536)+n[10]*u),d[11]=65535&(r=(0|r/65536)+n[11]*u),d[12]=65535&(r=(0|r/65536)+n[12]*u),d[13]=65535&(r=(0|r/65536)+n[13]*u),d[14]=65535&(r=(0|r/65536)+n[14]*u),d[15]=(0|r/65536)+n[15]*u,_reduce(d),d}function _dbl(n,r){var u,d,o,_,m;return o=_sqrmodp(_addmodp(n,r)),_=_sqrmodp(_submodp(n,r)),m=_submodp(o,_),u=_mulmodp(_,o),d=_mulmodp(_addmodp(_mulasmall(m),o),m),[u,d]}function _sum(n,r,u,d,o){var _,m,t,s;return t=_mulmodp(_submodp(n,r),_addmodp(u,d)),s=_mulmodp(_addmodp(n,r),_submodp(u,d)),_=_sqrmodp(_addmodp(t,s)),m=_mulmodp(_sqrmodp(_submodp(t,s)),o),[_,m]}function _generateKey(n){var r=crypto.randomBytes(32);n===!0&&(r[0]&=248,r[31]=127&r[31]|64);for(var u=[],d=0;d<r.length;d++)u.push(String.fromCharCode(r[d]));return u.join("")}var crypto=require("crypto"),ns={};ns.getbit=_getbit,ns.setbit=_setbit,ns.addmodp=_addmodp,ns.invmodp=_invmodp,ns.mulmodp=_mulmodp,ns.reduce=_reduce,ns.dbl=_dbl,ns.sum=_sum,ns.ZERO=_ZERO,ns.ONE=_ONE,ns.BASE=_BASE,ns.bigintadd=_bigintadd,ns.bigintsub=_bigintsub,ns.bigintcmp=_bigintcmp,ns.mulmodp=_mulmodp,ns.sqrmodp=_sqrmodp,ns.generateKey=_generateKey,module.exports=ns;