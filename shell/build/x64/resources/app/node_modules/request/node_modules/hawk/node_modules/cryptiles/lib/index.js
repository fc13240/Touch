var Crypto=require("crypto"),Boom=require("boom"),internals={};exports.randomString=function(r){var e=exports.randomBits(6*(r+1));if(e instanceof Error)return e;var t=e.toString("base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,"");return t.slice(0,r)},exports.randomBits=function(r){if(!r||0>r)return Boom.internal("Invalid random bits count");var e=Math.ceil(r/8);try{return Crypto.randomBytes(e)}catch(t){return Boom.internal("Failed generating random bits: "+t.message)}},exports.fixedTimeComparison=function(r,e){if("string"!=typeof r||"string"!=typeof e)return!1;var t=r.length===e.length?0:1;t&&(e=r);for(var n=0,o=r.length;o>n;++n){var a=r.charCodeAt(n),i=e.charCodeAt(n);t|=a^i}return 0===t};