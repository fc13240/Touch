function read(e){if("string"==typeof e){if(e.trim().match(/^[-]+[ ]*BEGIN/))return pem.read(e);if(e.match(/^\s*ssh-[a-z]/))return ssh.read(e);if(e.match(/^\s*ecdsa-/))return ssh.read(e);e=new Buffer(e,"binary")}else{if(assert.buffer(e),findPEMHeader(e))return pem.read(e);if(findSSHHeader(e))return ssh.read(e)}if(e.readUInt32BE(0)<e.length)return rfc4253.read(e);throw new Error("Failed to auto-detect format of key")}function findSSHHeader(e){for(var r=0;r<e.length&&(32===e[r]||10===e[r]||9===e[r]);)++r;return r+4<=e.length&&"ssh-"===e.slice(r,r+4).toString("ascii")?!0:r+6<=e.length&&"ecdsa-"===e.slice(r,r+6).toString("ascii")?!0:!1}function findPEMHeader(e){for(var r=0;r<e.length&&(32===e[r]||10===e[r]);)++r;if(45!==e[r])return!1;for(;r<e.length&&45===e[r];)++r;for(;r<e.length&&32===e[r];)++r;return r+5>e.length||"BEGIN"!==e.slice(r,r+5).toString("ascii")?!1:!0}function write(){throw new Error('"auto" format cannot be used for writing')}module.exports={read:read,write:write};var assert=require("assert-plus"),utils=require("../utils"),Key=require("../key"),PrivateKey=require("../private-key"),pem=require("./pem"),ssh=require("./ssh"),rfc4253=require("./rfc4253");