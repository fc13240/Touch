function deepCopy(e){var t,r,o="__deepCopy";if(e&&e[o])throw new Error("attempted deep copy of cyclic object");if(e&&e.constructor==Object){t={},e[o]=!0;for(r in e)r!=o&&(t[r]=deepCopy(e[r]));return delete e[o],t}if(e&&e.constructor==Array){for(t=[],e[o]=!0,r=0;r<e.length;r++)t.push(deepCopy(e[r]));return delete e[o],t}return e}function deepEqual(e,t){if(typeof e!=typeof t)return!1;if(null===e||null===t||"object"!=typeof e)return e===t;if(e.constructor!=t.constructor)return!1;var r;for(r in e){if(!t.hasOwnProperty(r))return!1;if(!deepEqual(e[r],t[r]))return!1}for(r in t)if(!e.hasOwnProperty(r))return!1;return!0}function isEmpty(e){var t;for(t in e)return!1;return!0}function forEachKey(e,t){for(var r in e)t(r,e[r])}function pluck(e,t){return mod_assert.equal(typeof t,"string"),pluckv(e,t)}function pluckv(e,t){if(null===e||"object"!=typeof e)return void 0;if(e.hasOwnProperty(t))return e[t];var r=t.indexOf(".");if(-1==r)return void 0;var o=t.substr(0,r);return e.hasOwnProperty(o)?pluckv(e[o],t.substr(r+1)):void 0}function flattenIter(e,t,r){doFlattenIter(e,t,[],r)}function doFlattenIter(e,t,r,o){var n,s;if(0===t)return n=r.slice(0),n.push(e),void o(n);mod_assert.ok(null!==e),mod_assert.equal(typeof e,"object"),mod_assert.equal(typeof t,"number"),mod_assert.ok(t>=0);for(s in e)n=r.slice(0),n.push(s),doFlattenIter(e[s],t-1,n,o)}function flattenObject(e,t){if(0===t)return[e];mod_assert.ok(null!==e),mod_assert.equal(typeof e,"object"),mod_assert.equal(typeof t,"number"),mod_assert.ok(t>=0);var r,o=[];for(r in e)flattenObject(e[r],t-1).forEach(function(e){o.push([r].concat(e))});return o}function startsWith(e,t){return e.substr(0,t.length)==t}function endsWith(e,t){return e.substr(e.length-t.length,t.length)==t}function iso8601(e){return"number"==typeof e&&(e=new Date(e)),mod_assert.ok(e.constructor===Date),mod_extsprintf.sprintf("%4d-%02d-%02dT%02d:%02d:%02d.%03dZ",e.getUTCFullYear(),e.getUTCMonth()+1,e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds())}function rfc1123(e){return mod_extsprintf.sprintf("%s, %02d %s %04d %02d:%02d:%02d GMT",RFC1123_DAYS[e.getUTCDay()],e.getUTCDate(),RFC1123_MONTHS[e.getUTCMonth()],e.getUTCFullYear(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds())}function parseDateTime(e){var t=+e;return new Date(isNaN(t)?e:t)}function validateJsonObjectJS(e,t){var r=mod_jsonschema.validate(t,e);if(0===r.errors.length)return null;var o,n,s=r.errors[0],i=s.property,a=s.message.toLowerCase();-1!=(o=a.indexOf("the property "))&&-1!=(n=a.indexOf(" is not defined in the schema and the schema does not allow additional properties"))&&(o+="the property ".length,i=""===i?a.substr(o,n-o):i+"."+a.substr(o,n-o),a="unsupported property");var u=new mod_verror.VError('property "%s": %s',i,a);return u.jsv_details=s,u}function randElt(e){return mod_assert.ok(Array.isArray(e)&&e.length>0,"randElt argument must be a non-empty array"),e[Math.floor(Math.random()*e.length)]}function assertHrtime(e){mod_assert.ok(e[0]>=0&&e[1]>=0,"negative numbers not allowed in hrtimes"),mod_assert.ok(e[1]<1e9,"nanoseconds column overflow")}function hrtimeDiff(e,t){assertHrtime(e),assertHrtime(t),mod_assert.ok(e[0]>t[0]||e[0]==t[0]&&e[1]>=t[1],"negative differences not allowed");var r=[e[0]-t[0],0];return e[1]>=t[1]?r[1]=e[1]-t[1]:(r[0]--,r[1]=1e9-(t[1]-e[1])),r}function hrtimeNanosec(e){return assertHrtime(e),Math.floor(1e9*e[0]+e[1])}function hrtimeMicrosec(e){return assertHrtime(e),Math.floor(1e6*e[0]+e[1]/1e3)}function hrtimeMillisec(e){return assertHrtime(e),Math.floor(1e3*e[0]+e[1]/1e6)}function hrtimeAccum(e,t){return assertHrtime(e),assertHrtime(t),e[1]+=t[1],e[1]>=1e9&&(e[0]++,e[1]-=1e9),e[0]+=t[0],e}function hrtimeAdd(e,t){assertHrtime(e);var r=[e[0],e[1]];return hrtimeAccum(r,t)}function extraProperties(e,t){mod_assert.ok("object"==typeof e&&null!==e,"obj argument must be a non-null object"),mod_assert.ok(Array.isArray(t),"allowed argument must be an array of strings");for(var r=0;r<t.length;r++)mod_assert.ok("string"==typeof t[r],"allowed argument must be an array of strings");return Object.keys(e).filter(function(e){return-1===t.indexOf(e)})}function mergeObjects(e,t,r){var o,n;if(o={},r)for(n in r)o[n]=r[n];if(e)for(n in e)o[n]=e[n];if(t)for(n in t)o[n]=t[n];return o}var mod_assert=require("assert"),mod_util=require("util"),mod_extsprintf=require("extsprintf"),mod_verror=require("verror"),mod_jsonschema=require("json-schema");exports.deepCopy=deepCopy,exports.deepEqual=deepEqual,exports.isEmpty=isEmpty,exports.forEachKey=forEachKey,exports.pluck=pluck,exports.flattenObject=flattenObject,exports.flattenIter=flattenIter,exports.validateJsonObject=validateJsonObjectJS,exports.validateJsonObjectJS=validateJsonObjectJS,exports.randElt=randElt,exports.extraProperties=extraProperties,exports.mergeObjects=mergeObjects,exports.startsWith=startsWith,exports.endsWith=endsWith,exports.iso8601=iso8601,exports.rfc1123=rfc1123,exports.parseDateTime=parseDateTime,exports.hrtimediff=hrtimeDiff,exports.hrtimeDiff=hrtimeDiff,exports.hrtimeAccum=hrtimeAccum,exports.hrtimeAdd=hrtimeAdd,exports.hrtimeNanosec=hrtimeNanosec,exports.hrtimeMicrosec=hrtimeMicrosec,exports.hrtimeMillisec=hrtimeMillisec;var RFC1123_MONTHS=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],RFC1123_DAYS=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];